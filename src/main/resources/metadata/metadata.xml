<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ComponentMetadata ComponentId="ctype::Adapter/cname::SharePoint/vendor::sap/version::1.0.0" 
                   ComponentName="sap:SharePoint"
                   UIElementType="Adapter" 
                   IsExtension="false" 
                   IsFinal="true" 
                   IsPreserves="true"
                   IsDefaultGenerator="true" 
                   ComponentDisplayName="SharePoint Adapter"
                   xmlns:gen="http://www.sap.hci.adk.com/gen">
    
    <!-- Sender Variant -->
    <Variant VariantName="SharePoint Sender"
             VariantId="ctype::AdapterVariant/cname::SharePoint/vendor::sap/tp::sap-sharepoint/mp::sap-sharepoint/direction::Sender"
             MetadataVersion="2.0" 
             gen:RuntimeComponentBaseUri="sap-sharepoint" 
             AttachmentBehavior="Preserve">
        
        <InputContent Cardinality="1" Scope="outsidepool" MessageCardinality="1" isStreaming="false">
            <Content>
                <ContentType>Any</ContentType>
                <Schema xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            </Content>
        </InputContent>
        
        <OutputContent Cardinality="1" Scope="outsidepool" MessageCardinality="1" isStreaming="false">
            <Content>
                <ContentType>Any</ContentType>
                <Schema xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            </Content>
        </OutputContent>
        
        <Tab id="connection">
            <GuiLabels>
                <Label language="EN">Connection</Label>
            </GuiLabels>
            
            <AttributeGroup id="connectionSettings">
                <Name>Connection Settings</Name>
                <GuiLabels>
                    <Label language="EN">Connection Settings</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>siteUrl</ReferenceName>
                    <description>SharePoint site URL (e.g., https://contoso.sharepoint.com/sites/sitename)</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>authenticationType</ReferenceName>
                    <description>Authentication type for SharePoint connection</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>tenantId</ReferenceName>
                    <description>Azure AD Tenant ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>clientId</ReferenceName>
                    <description>Azure AD Application (Client) ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>clientSecret</ReferenceName>
                    <description>Azure AD Application Client Secret</description>
                </AttributeReference>
            </AttributeGroup>
        </Tab>
        
        <Tab id="processing">
            <GuiLabels>
                <Label language="EN">Processing</Label>
            </GuiLabels>
            
            <AttributeGroup id="operationSettings">
                <Name>Operation Settings</Name>
                <GuiLabels>
                    <Label language="EN">Operation Settings</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>operationName</ReferenceName>
                    <description>SharePoint operation to perform</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>driveId</ReferenceName>
                    <description>SharePoint Drive ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>folderPath</ReferenceName>
                    <description>Folder path in SharePoint</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>postProcessing</ReferenceName>
                    <description>Post-processing action after file download</description>
                </AttributeReference>
            </AttributeGroup>
            
            <AttributeGroup id="schedulerSettings">
                <Name>Scheduler</Name>
                <GuiLabels>
                    <Label language="EN">Scheduler</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>delay</ReferenceName>
                    <description>Polling delay in milliseconds</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>initialDelay</ReferenceName>
                    <description>Initial delay before first poll in milliseconds</description>
                </AttributeReference>
            </AttributeGroup>
        </Tab>
    </Variant>
    
    <!-- Receiver Variant -->
    <Variant VariantName="SharePoint Receiver"
             VariantId="ctype::AdapterVariant/cname::SharePoint/vendor::sap/tp::sap-sharepoint/mp::sap-sharepoint/direction::Receiver"
             IsRequestResponse="true" 
             MetadataVersion="2.0" 
             gen:RuntimeComponentBaseUri="sap-sharepoint"
             AttachmentBehavior="Preserve">
        
        <InputContent Cardinality="1" Scope="outsidepool" MessageCardinality="1" isStreaming="false">
            <Content>
                <ContentType>Any</ContentType>
                <Schema xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            </Content>
        </InputContent>
        
        <OutputContent Cardinality="1" Scope="outsidepool" MessageCardinality="1" isStreaming="false">
            <Content>
                <ContentType>Any</ContentType>
                <Schema xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            </Content>
        </OutputContent>
        
        <Tab id="connection">
            <GuiLabels>
                <Label language="EN">Connection</Label>
            </GuiLabels>
            
            <AttributeGroup id="connectionSettings">
                <Name>Connection Settings</Name>
                <GuiLabels>
                    <Label language="EN">Connection Settings</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>siteUrl</ReferenceName>
                    <description>SharePoint site URL (e.g., https://contoso.sharepoint.com/sites/sitename)</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>authenticationType</ReferenceName>
                    <description>Authentication type for SharePoint connection</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>tenantId</ReferenceName>
                    <description>Azure AD Tenant ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>clientId</ReferenceName>
                    <description>Azure AD Application (Client) ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>clientSecret</ReferenceName>
                    <description>Azure AD Application Client Secret</description>
                </AttributeReference>
            </AttributeGroup>
        </Tab>
        
        <Tab id="processing">
            <GuiLabels>
                <Label language="EN">Processing</Label>
            </GuiLabels>
            
            <AttributeGroup id="operationSettings">
                <Name>Operation Settings</Name>
                <GuiLabels>
                    <Label language="EN">Operation Settings</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>operation</ReferenceName>
                    <description>SharePoint operation category</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>operationName</ReferenceName>
                    <description>Specific SharePoint operation to perform</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>responseFormat</ReferenceName>
                    <description>Response format (JSON or XML)</description>
                </AttributeReference>
            </AttributeGroup>
            
            <AttributeGroup id="resourceSettings">
                <Name>Resource Settings</Name>
                <GuiLabels>
                    <Label language="EN">Resource Settings</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>listId</ReferenceName>
                    <description>SharePoint List ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>driveId</ReferenceName>
                    <description>SharePoint Drive ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>itemId</ReferenceName>
                    <description>SharePoint Item ID</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>fileName</ReferenceName>
                    <description>File name for upload operations</description>
                </AttributeReference>
            </AttributeGroup>
            
            <AttributeGroup id="paginationSettings">
                <Name>Pagination</Name>
                <GuiLabels>
                    <Label language="EN">Pagination</Label>
                </GuiLabels>
                <AttributeReference>
                    <ReferenceName>enablePagination</ReferenceName>
                    <description>Enable pagination for large result sets</description>
                </AttributeReference>
                <AttributeReference>
                    <ReferenceName>pageSize</ReferenceName>
                    <description>Number of items per page</description>
                </AttributeReference>
            </AttributeGroup>
        </Tab>
    </Variant>
    
    <!-- Attribute Metadata Definitions -->
    <AttributeMetadata>
        <Name>siteUrl</Name>
        <Usage>true</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Site URL</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>authenticationType</Name>
        <Usage>true</Usage>
        <DataType>xsd:string</DataType>
        <Default>OAuth2ClientCredentials</Default>
        <isparameterized>false</isparameterized>
        <GuiLabels>
            <Label language="EN">Authentication Type</Label>
        </GuiLabels>
        <FixedValues>
            <FixedValue>
                <Value>OAuth2ClientCredentials</Value>
                <GuiLabels>
                    <Label language="EN">OAuth2 Client Credentials</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>OAuth2</Value>
                <GuiLabels>
                    <Label language="EN">OAuth2 Authorization Code</Label>
                </GuiLabels>
            </FixedValue>
        </FixedValues>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>tenantId</Name>
        <Usage>true</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Tenant ID</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>clientId</Name>
        <Usage>true</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Client ID</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>clientSecret</Name>
        <Usage>true</Usage>
        <DataType>xsd:password</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Client Secret</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>operation</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default>Sites</Default>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Operation</Label>
        </GuiLabels>
        <FixedValues>
            <FixedValue>
                <Value>Sites</Value>
                <GuiLabels>
                    <Label language="EN">Sites</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>Lists</Value>
                <GuiLabels>
                    <Label language="EN">Lists</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>ListItems</Value>
                <GuiLabels>
                    <Label language="EN">List Items</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>Files</Value>
                <GuiLabels>
                    <Label language="EN">Files</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>Permissions</Value>
                <GuiLabels>
                    <Label language="EN">Permissions</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>Columns</Value>
                <GuiLabels>
                    <Label language="EN">Columns</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>ContentTypes</Value>
                <GuiLabels>
                    <Label language="EN">Content Types</Label>
                </GuiLabels>
            </FixedValue>
        </FixedValues>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>operationName</Name>
        <Usage>true</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Operation Name</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>responseFormat</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default>JSON</Default>
        <isparameterized>false</isparameterized>
        <GuiLabels>
            <Label language="EN">Response Format</Label>
        </GuiLabels>
        <FixedValues>
            <FixedValue>
                <Value>JSON</Value>
                <GuiLabels>
                    <Label language="EN">JSON</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>XML</Value>
                <GuiLabels>
                    <Label language="EN">XML</Label>
                </GuiLabels>
            </FixedValue>
        </FixedValues>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>listId</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">List ID</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>driveId</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Drive ID</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>itemId</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Item ID</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>fileName</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">File Name</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>folderPath</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default/>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Folder Path</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>enablePagination</Name>
        <Usage>false</Usage>
        <DataType>xsd:boolean</DataType>
        <Default>false</Default>
        <isparameterized>false</isparameterized>
        <GuiLabels>
            <Label language="EN">Enable Pagination</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>pageSize</Name>
        <Usage>false</Usage>
        <DataType>xsd:integer</DataType>
        <Default>100</Default>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Page Size</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>postProcessing</Name>
        <Usage>false</Usage>
        <DataType>xsd:string</DataType>
        <Default>Keep</Default>
        <isparameterized>false</isparameterized>
        <GuiLabels>
            <Label language="EN">Post Processing</Label>
        </GuiLabels>
        <FixedValues>
            <FixedValue>
                <Value>Keep</Value>
                <GuiLabels>
                    <Label language="EN">Keep</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>Delete</Value>
                <GuiLabels>
                    <Label language="EN">Delete</Label>
                </GuiLabels>
            </FixedValue>
            <FixedValue>
                <Value>MarkProcessed</Value>
                <GuiLabels>
                    <Label language="EN">Mark as Processed</Label>
                </GuiLabels>
            </FixedValue>
        </FixedValues>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>delay</Name>
        <Usage>false</Usage>
        <DataType>xsd:long</DataType>
        <Default>60000</Default>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Delay (ms)</Label>
        </GuiLabels>
    </AttributeMetadata>
    
    <AttributeMetadata>
        <Name>initialDelay</Name>
        <Usage>false</Usage>
        <DataType>xsd:long</DataType>
        <Default>1000</Default>
        <isparameterized>true</isparameterized>
        <GuiLabels>
            <Label language="EN">Initial Delay (ms)</Label>
        </GuiLabels>
    </AttributeMetadata>
</ComponentMetadata>
